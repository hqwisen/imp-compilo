apply plugin: 'java'
apply plugin: 'application'

sourceCompatibility = 1.8
targetCompatibility = 1.8

sourceSets {
    main {
        java {
            srcDir 'more/src'
        }
    }
    test {
        java {
            srcDir 'more/tests'
        }
    }
}

jar {
    manifest {
        attributes 'Implementation-Title': 'ImpCompilo',
                   'Implementation-Version': '',
                   'Main-Class': 'Main'
    }
    baseName 'imp-compilo'
    destinationDir file('dist/')
}

task generateMain {
    javaexec {
        main='-jar';
        args = ['dist/lib/jflex.jar', 'more/src/LexicalAnalyzer.flex']
    }
}

task generateJar (dependsOn: [generateMain, jar])

task scan (dependsOn: generateJar) {
  javaexec {
      main='-jar';
      args = ['dist/imp-compilo.jar', project.input]
  }
}

repositories{
    mavenCentral()
}

dependencies {
    // compile fileTree(dir: 'dist/lib', include: ['*.jar'])
    testCompile group: 'junit', name: 'junit', version: '4.+'
}
